 - name: Check if Metasploit DB config exists
   ansible.builtin.stat:
     path: "{{ ansible_env.HOME | default('~') }}/.msf4/database.yml"
   register: msf_db_config

 - name: Initialize Metasploit database
   become: true
   ansible.builtin.command: msfdb init
   when: not msf_db_config.stat.exists
   changed_when: true
   args:
     warn: false
